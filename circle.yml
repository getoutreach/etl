machine:
  timezone:
    America/Los_Angeles
  ruby:
    version: 2.3.3
  hosts:
    circlehost: 127.0.0.1

dependencies:
  pre:
    - gem update --system
    - gem install bundler

test:
  pre:
    - mkdir "$HOME/jobs"        # Use an empty directory for jobs
    - mkdir "$HOME/config"
    - "$HOME/etl/bin/generate_config_files -i $HOME/etl/etc/erb_templates/ -o $HOME/config/ --job-dir $HOME/jobs"
  override:
    - 'bundle exec rspec --color --require spec_helper spec --format progress':
        environment:
          ETL_CONFIG_DIR: "$HOME/config"
